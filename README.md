# AI Town ğŸ¤–âœ¨

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![TypeScript](https://img.shields.io/badge/TypeScript-007ACC?logo=typescript&logoColor=white)](https://www.typescriptlang.org/)
[![React](https://img.shields.io/badge/React-20232A?logo=react&logoColor=61DAFB)](https://reactjs.org/)
[![Convex](https://img.shields.io/badge/Convex-000000?logo=convex&logoColor=white)](https://convex.dev/)

A virtual town where AI characters interact, form relationships, and live out their lives in a dynamic 2D world. Built with modern web technologies and powered by AI language models.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AI TOWN WORLD                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ˜ï¸ Virtual Village    ğŸ’¬ Conversations    ğŸ® Interactive  â”‚
â”‚  ğŸ¤– AI Characters      ğŸ“ Location-based   ğŸŒ Real-time    â”‚
â”‚  ğŸ—ºï¸ 2D Tile Map        ğŸ­ Personalities   âš¡ Persistent  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸŒŸ Project Overview

AI Town is a sophisticated simulation where AI agents navigate a virtual world, engage in conversations, form relationships, and exhibit emergent behaviors. Each character has their own personality, goals, and social dynamics that evolve over time.

### âœ¨ Key Features

- **ğŸ¤– Intelligent AI Characters**: Each with unique personalities, memories, and behaviors
- **ğŸ—ºï¸ Interactive 2D World**: Tile-based map with locations for exploration and interaction
- **ğŸ’¬ Dynamic Conversations**: AI agents engage in contextual, meaningful dialogues
- **ğŸ“ Location System**: Characters move between different locations in the town
- **ğŸ­ Social Relationships**: Complex relationship dynamics between characters
- **âš¡ Real-time Updates**: Live simulation with continuous character development
- **ğŸ® Player Interaction**: Join the world as a human player and interact with AI agents

## ğŸ—ï¸ Architecture

### Core Technologies

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TECH STACK                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”§ Backend              ğŸ¨ Frontend                       â”‚
â”‚  â”œâ”€â”€ Convex Database     â”œâ”€â”€ React 18 + TypeScript         â”‚
â”‚  â”œâ”€â”€ Real-time sync      â”œâ”€â”€ PIXI.js (Game Engine)         â”‚
â”‚  â”œâ”€â”€ Serverless functionsâ”œâ”€â”€ Tailwind CSS                  â”‚
â”‚  â””â”€â”€ AI/ML Pipeline      â””â”€â”€ Vite Build System             â”‚
â”‚                                                             â”‚
â”‚  ğŸ¤– AI Integration       ğŸ® Game Engine                    â”‚
â”‚  â”œâ”€â”€ OpenAI API          â”œâ”€â”€ Tile-based rendering           â”‚
â”‚  â”œâ”€â”€ Character AI        â”œâ”€â”€ Viewport system               â”‚
â”‚  â”œâ”€â”€ Conversation logic  â”œâ”€â”€ Sprite animations             â”‚
â”‚  â””â”€â”€ Behavior patterns   â””â”€â”€ Interactive controls          â”‚
â”‚                                                             â”‚
â”‚  ğŸ“Š Data Storage         ğŸš€ Deployment                     â”‚
â”‚  â”œâ”€â”€ Character states    â”œâ”€â”€ Docker containers              â”‚
â”‚  â”œâ”€â”€ Conversations       â”œâ”€â”€ Fly.io hosting                 â”‚
â”‚  â”œâ”€â”€ World map data      â”œâ”€â”€ Environment variables          â”‚
â”‚  â””â”€â”€ Game history        â””â”€â”€ Production deployment         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### System Components

- **Game Engine**: Real-time simulation engine managing character behaviors and world state
- **AI System**: Language model integration for character personalities and conversations
- **Database**: Convex backend for real-time data synchronization
- **Frontend**: React-based interface with PIXI.js for 2D graphics
- **Map Editor**: Built-in level editor for creating custom town layouts

## ğŸ“ Project Structure

```
ai-town/
â”œâ”€â”€ ğŸ“ convex/           # Backend logic and database schema
â”‚   â”œâ”€â”€ aiTown/         # Game-specific backend code
â”‚   â”œâ”€â”€ agent/          # AI behavior and conversation logic
â”‚   â””â”€â”€ engine/         # Core game engine implementation
â”œâ”€â”€ ğŸ“ src/              # Frontend source code
â”‚   â”œâ”€â”€ components/     # React components
â”‚   â”œâ”€â”€ services/       # API and integration services
â”‚   â”œâ”€â”€ hooks/          # Custom React hooks
â”‚   â””â”€â”€ editor/         # Built-in map editor
â”œâ”€â”€ ğŸ“ data/            # Game data and configurations
â”‚   â”œâ”€â”€ characters.ts   # AI character definitions
â”‚   â”œâ”€â”€ spritesheets/   # Character sprites and animations
â”‚   â””â”€â”€ animations/     # Animation data
â”œâ”€â”€ ğŸ“ assets/          # Static assets (images, fonts)
â”œâ”€â”€ ğŸ“ public/          # Public assets for serving
â”œâ”€â”€ ğŸ“ server/          # Server implementations
â”œâ”€â”€ ğŸ“ docker/          # Docker configuration
â”œâ”€â”€ ğŸ“ fly/            # Fly.io deployment config
â””â”€â”€ ğŸ“ scripts/        # Utility and deployment scripts
```

## ğŸš€ Quick Start

### Prerequisites

- **Node.js** 18+ (LTS version recommended)
- **npm** or **yarn** package manager
- **Git** for version control
- **Convex** account (free tier available)

### Installation

```bash
# 1. Clone the repository
git clone https://github.com/a16z-infra/ai-town.git
cd ai-town

# 2. Install dependencies
npm install

# 3. Set up Convex (Recommended)
./scripts/setup-convex.sh         # Interactive setup
# ./scripts/setup-convex.sh --dry-run  # Preview setup steps
# ./scripts/setup-convex.sh --help     # Show help

# Alternative: Manual Convex Setup
# cp config/.env.example .env.local
# npx convex dev
# npx convex deploy

# 4. Start the development server
npm run dev
```

### Environment Configuration

Create a `.env.local` file with the following variables:

```bash
# AI Model Configuration
OPENAI_API_KEY=your-openai-api-key
ANTHROPIC_API_KEY=your-anthropic-api-key  # Optional

# Convex Configuration
CONVEX_DEPLOYMENT=your-convex-deployment-url

# Development
VITE_CONVEX_URL=http://localhost:3210
```

## ğŸ® Usage Guide

### Playing the Game

1. **Start the Application**: Run `npm run dev` to launch the development server
2. **Open Browser**: Navigate to `http://localhost:5173`
3. **Join the World**: Enter your name and join as a human player
4. **Explore**: Click on the map to move your character
5. **Interact**: Click on AI characters to start conversations
6. **Observe**: Watch AI characters interact with each other

### Map Editor

Create custom town layouts using the built-in editor:

```bash
# Launch the map editor
npm run level-editor

# Access at http://localhost:5174
```

**Editor Features:**

- Tile-based map creation
- Sprite placement and animation
- Location configuration
- Export/import map files

### Character Configuration

AI characters are defined in `data/characters.ts`. Each character includes:

```typescript
{
  name: 'Character Name',
  identity: 'Character personality and background',
  plan: 'Character goals and behavior patterns',
  // Additional configuration...
}
```

## ğŸ› ï¸ Development

### Development Commands

```bash
# Development
npm run dev              # Start frontend + backend
npm run dev:frontend     # Frontend only
npm run dev:backend      # Convex backend only

# Testing
npm run test             # Run all tests
npm run lint             # ESLint checking

# Building
npm run build            # Production build
npm run preview          # Preview production build

# Tools
npm run level-editor     # Map editor
npm run dashboard        # Convex dashboard

# Custom LLM Provider Testing
npm run test:llm-providers              # Quick test all providers
npm run test:llm-providers:full         # Comprehensive test with performance
npm run test:llm-providers:report       # Save timestamped report
node scripts/test-custom-providers.js              # Direct script access
node scripts/test-custom-providers.js --verbose    # Detailed output
node scripts/test-custom-providers.js --quick      # Skip performance tests
./scripts/test-llm-providers quick                  # Easy wrapper commands
```

### ğŸ¤– Custom LLM Provider Testing

AI Town supports custom LLM providers for enhanced flexibility. Use the built-in test script to verify your provider configuration:

```bash
# Quick test of all configured providers
node scripts/test-custom-providers.js --quick

# Comprehensive test with performance benchmarks
node scripts/test-custom-providers.js --verbose

# Save test report to file
node scripts/test-custom-providers.js --report-file test-results.txt
```

The script tests:

- âœ… Provider connectivity and authentication
- ğŸ’¬ Chat completion functionality
- ğŸ”¤ Embedding generation
- âš¡ Performance benchmarks
- ğŸ”„ Fallback logic validation

**Configuration**: Set up providers in `config/custom-providers.env`:

```bash
# OpenAI
OPENAI_API_KEY=your-key
OPENAI_API_BASE_URL=https://api.openai.com/v1

# Custom Provider
MYPROVIDER_API_KEY=your-custom-key
MYPROVIDER_API_BASE_URL=https://my-provider.com/v1
```

ğŸ“– **Full Guide**: See `scripts/README-test-custom-providers.md` for detailed instructions.

### Adding New Characters

1. **Define Character**: Add character definition in `data/characters.ts`
2. **Create Sprite**: Add character sprite in `data/spritesheets/`
3. **Configure AI**: Set up personality and behavior patterns
4. **Test**: Verify character integration in the game world

### Custom Maps

1. **Use Editor**: Create maps with the built-in level editor
2. **Export Maps**: Save map configurations to `src/editor/maps/`
3. **Load Maps**: Configure game to load custom map files
4. **Test Gameplay**: Verify map functionality and character navigation

### AI Behavior Customization

AI character behaviors are controlled through:

- **Conversation Logic**: `convex/agent/conversation.ts`
- **Memory System**: `convex/agent/memory.ts`
- **Movement Patterns**: `convex/aiTown/movement.ts`
- **Input Handling**: `convex/aiTown/inputHandler.ts`

## ğŸš€ Deployment

### Fly.io Deployment (Recommended)

```bash
# 1. Install Fly.io CLI
brew install flyctl

# 2. Login to Fly.io
fly auth login

# 3. Deploy Convex backend
npx convex deploy

# 4. Deploy frontend
fly launch
fly secrets set VITE_CONVEX_URL=<your-convex-url>
fly deploy
```

### Docker Deployment

```bash
# Build and run with Docker Compose
docker-compose up --build

# Access the application
# Frontend: http://localhost:5173
# API: http://localhost:3001
```

### Production Configuration

For production deployment:

1. **Set Environment Variables**: Configure all required secrets
2. **Update Allowed Hosts**: Modify `vite.config.ts` for production domains
3. **Enable HTTPS**: Configure SSL certificates
4. **Set Up Monitoring**: Implement health checks and logging
5. **Scale Resources**: Adjust resources based on user load

## ğŸ¤– AI Integration

### Supported AI Providers

- **OpenAI GPT Models**: Primary choice for character conversations
- **Anthropic Claude**: Alternative AI provider
- **Local Models**: Support for local Ollama instances

### Character AI System

Each AI character features:

- **Memory System**: Remembers past interactions and relationships
- **Personality Traits**: Consistent behavior patterns
- **Goal-directed Behavior**: Characters pursue personal objectives
- **Social Dynamics**: Relationship building and maintenance
- **Context Awareness**: Responds to environment and other characters

### Conversation Engine

- **Dynamic Responses**: Context-aware dialogue generation
- **Relationship Tracking**: Characters remember past conversations
- **Group Conversations**: Multi-character interaction support
- **Emotional States**: Characters express and respond to emotions

## ğŸ“Š Monitoring & Debugging

### Convex Dashboard

Monitor your backend in real-time:

```bash
npm run dashboard
```

**Dashboard Features:**

- Real-time data viewer
- Function execution logs
- Database schema inspection
- Performance metrics

### Game Debugging

- **Debug Mode**: Enable debug overlays in the game
- **Console Logs**: Comprehensive logging system
- **State Inspection**: View character and world states
- **Performance Monitoring**: FPS and memory usage tracking

## ğŸ¨ Customization

### Visual Assets

- **Sprites**: Character and object sprites in `assets/spritesheets/`
- **Tilesets**: Map tiles in `src/editor/tilesets/`
- **Fonts**: Custom fonts in `public/assets/fonts/`
- **UI Elements**: Interface components in `assets/ui/`

### Audio

- **Background Music**: Ambient game music
- **Sound Effects**: Interaction and movement sounds
- **Volume Controls**: Adjustable audio settings

### Themes

Customize the appearance:

- **Color Schemes**: Modify CSS variables
- **Layout Adjustments**: Responsive design configurations
- **Animation Timing**: Control animation speeds and transitions

## ğŸ¤ Contributing

We welcome contributions! Please see our [Contributing Guidelines](CONTRIBUTING.md) for details.

### Areas for Contribution

- **ğŸ¤– AI Behaviors**: Improve character intelligence and interactions
- **ğŸ¨ Graphics**: Create new sprites, tiles, and visual assets
- **ğŸ”§ Features**: Add new gameplay mechanics and systems
- **ğŸ› Bug Fixes**: Help identify and resolve issues
- **ğŸ“š Documentation**: Improve guides and API documentation

### Development Setup

1. **Fork Repository**: Create your own fork on GitHub
2. **Clone Fork**: Clone your fork locally
3. **Create Branch**: `git checkout -b feature/your-feature-name`
4. **Make Changes**: Implement your contribution
5. **Test**: Verify changes work correctly
6. **Submit PR**: Create a pull request with detailed description

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## ğŸ†˜ Support

For support and questions:

- **ğŸ“– Documentation**: [Convex Docs](https://docs.convex.dev/)
- **ğŸ’¬ Discussions**: [GitHub Discussions](https://github.com/a16z-infra/ai-town/discussions)
- **ğŸ› Issues**: [GitHub Issues](https://github.com/a16z-infra/ai-town/issues)
- **ğŸ® Discord**: [Community Discord](https://discord.gg/convex)

## ğŸ—ºï¸ Roadmap

### Current Features

- âœ… Basic AI character simulation
- âœ… 2D tile-based world
- âœ… Real-time conversations
- âœ… Map editor
- âœ… Player interaction

### Planned Enhancements

- ğŸ”„ Advanced AI behaviors
- ğŸ”„ Mobile app support
- ğŸ”„ Multiplayer functionality
- ğŸ”„ Voice interactions
- ğŸ”„ Expanded world features
- ğŸ”„ Performance optimizations

---

**AI Town** - Where artificial intelligence comes to life in a virtual world. ğŸš€âœ¨

_Built with â¤ï¸ by the a16z-infra team_
